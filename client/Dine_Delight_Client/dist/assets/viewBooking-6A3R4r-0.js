import{k as S,j as s,r as l,U as N,h as T,f as O,u as D,M as B,W as _,I as A,C as $}from"./index-Cxd2xyy7.js";import{B as g}from"./Button-CDaYHqNo.js";import{a as y}from"./axiosService-BTXOZOBt.js";import{s as w}from"./toaster-BM9EEUR7.js";import{T as k}from"./index-CO90U5bs.js";import{R as E}from"./index-BjmB805p.js";import{g as F,s as U}from"./util-B1cTCt3M.js";import{C as H}from"./ConfirmationModal-5Q3xI2Es.js";import{S as q}from"./StarRating-BXr2SbRs.js";import{a as L}from"./axios-B6xwUs71.js";import{C}from"./cooking-pot-6fTJ39zO.js";import{C as W}from"./calendar-CucTk8Mi.js";import{C as z}from"./clock-F5pxEXCI.js";import{U as G}from"./users-BJkYAmeH.js";import"./index-VWaDGczM.js";import"./logout-B7Q3BYGa.js";import"./Set_GetLs-jfIHgayU.js";import"./index-Cw9uVxN_.js";/**
 * @license lucide-react v0.341.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=S("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.341.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=S("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),V=()=>s.jsx("div",{className:"flex justify-center items-center ",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"text-3xl font-semibold mb-4",children:"Thank You!"}),s.jsx("p",{className:"text-lg text-gray-700 mb-6",children:"Your review has been submitted successfully."})]})}),X=({restauranName:n,restaurantId:e})=>{const[c,x]=l.useState(1),[m,i]=l.useState(""),[u,r]=l.useState(!1),[h,p]=l.useState(!1),o=d=>{d.preventDefault(),r(!0),y.post(N+"/review/add",{restaurantId:e,rating:c,description:m}).then(({data:f})=>{f.success&&p(!0)}).catch(()=>w("Oops,Something went wrong.Please try again later.")).finally(()=>r(!1))};return s.jsx("div",{className:"flex justify-center items-center mt-2 border shadow-md rounded-md p-4",children:h?s.jsx(V,{}):s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsxs("h1",{className:"text-xl font-semibold text-center mb-4",children:["Rate your experience with ",n??"restaurant"]}),s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(q,{edit:!0,value:c,onChange:d=>x(d),className:"flex"}),s.jsx("span",{className:"text-sm",children:"(Click to rate)"})]}),s.jsxs("form",{onSubmit:o,className:"w-full max-w-md",children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{htmlFor:"review",className:"block text-sm font-semibold mb-1",children:"Write your review:"}),s.jsx("textarea",{name:"review",className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:border-blue-500",rows:1,placeholder:"Share your experience...",value:m,onChange:d=>i(d.target.value),required:!0})]}),s.jsx(g,{buttontype:"submit",label:"Submit Review",isDisabled:u,className:"bg-blue-500 hover:bg-blue-600"})]})]})})},K=({cookingStatus:n})=>{const{color:e,width:c}=F(n);return s.jsxs("div",{className:"max-w-2xl ",children:[s.jsxs("div",{className:"flex justify-between mb-1",children:[s.jsx("span",{className:"text-base font-medium text-blue-700 dark:text-white",children:"Cooking status"}),s.jsxs("span",{className:"inline-flex items-center gap-2 text-sm font-medium text-blue-700 dark:text-white",children:[n," ",s.jsx(C,{})]})]}),s.jsx("div",{className:"max-w-2xl bg-gray-200 rounded-full h-2.5 dark:bg-gray-700",children:s.jsx("div",{className:`bg-${e}-600 h-2.5 rounded-full`,style:{width:c,backgroundColor:e}})})]})},fe=()=>{var v,b;const{id:n}=T(),[e,c]=l.useState(null),[x,m]=l.useState(!1),[i,u]=l.useState(null),[r,h]=l.useState([]),p=O(t=>t.UserSlice),o=D();l.useEffect(()=>{y.get(N+`/bookings/${n}`).then(({data:t})=>{const{bookingDetails:a,reviews:j,preOrder:R}=t;c(a),u(j),h(R)}).catch(()=>w("Oops! Something went wrong","error"))},[]);const d=()=>{var t;L.post($+"/conversations",{senderId:p.id,recieverId:(t=e==null?void 0:e.restaurantId)==null?void 0:t._id}).then(({data:a})=>{const j=a.chats._id;o(`/chat?conversation=${j}`)}).catch(()=>{console.log("error in sending chat")})},f=()=>{y.patch(N+`/booking/cancel/${e==null?void 0:e.bookingId}`).then(({data:t})=>{c(a=>({...a,bookingStatus:t.booking.bookingStatus??(a==null?void 0:a.bookingStatus)}))}).catch(()=>w("Oops! Something went wrong","error")),m(!1)},I=l.useMemo(()=>{if(i&&i.length&&e)return!!i.find(a=>a.restaurantId===e.restaurantId._id&&a.userId._id===e.userId._id)},[i,e]),M=l.useMemo(()=>{if(r&&r.length)return r.reduce((t,a)=>t+=a.price,0)},[r]),P=["Cancelled","Checked-in","No-show","Completed"];return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"container mx-auto px-4 py-2 border rounded-lg shadow-md   mt:10 sm:mt-0",children:[s.jsx("h1",{className:"text-center mb-4 text-2xl font-semibold",children:"Booking Details"}),s.jsx("hr",{className:"mt-2 h-0.5 border-t border-gray-300"}),s.jsxs("div",{className:"grid grid-cols-6 gap-4 ",children:[s.jsxs("div",{className:"col-span-6 md:col-span-3 p-4 space-y-3 mt-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Y,{}),s.jsx("p",{className:"text-lg font-semibold font-display ",children:e==null?void 0:e.restaurantId.restaurantName})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(W,{}),s.jsx("p",{className:"text-sm",children:((v=e==null?void 0:e.tableSlotId)==null?void 0:v.slotDate)&&new Date(e.tableSlotId.slotDate).toLocaleDateString("en-us",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(z,{}),s.jsxs("p",{className:"text-sm",children:[e==null?void 0:e.tableSlotId.startTime," -"," ",e==null?void 0:e.tableSlotId.endTime]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(B,{className:"h-6 w-6"}),s.jsx("p",{className:"text-sm",children:e==null?void 0:e.tableId.tableNumber})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(G,{}),s.jsxs("p",{className:"text-sm ",children:[e==null?void 0:e.tableId.capacity," Guests"]})]})]}),s.jsxs("div",{className:"col-span-6 md:col-span-3   p-4 space-y-2 mt-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(J,{className:"h-5 w-5"}),s.jsx("p",{className:"text-lg font-semibold ",children:e==null?void 0:e.bookingId})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(_,{className:"h-6 w-6"}),s.jsxs("p",{className:" font-medium",children:[e==null?void 0:e.paymentMethod," Payment"]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("p",{className:"text-lg font- ",children:"Payment Status:"}),s.jsxs("p",{className:"inline-flex gap-2 items-center font-medium",children:[e==null?void 0:e.paymentStatus,(e==null?void 0:e.paymentStatus)==="Paid"?s.jsx(A,{color:"#2eff51"}):(e==null?void 0:e.paymentStatus)==="Failed"?s.jsx(k,{className:"text-red-500"}):s.jsx(E,{className:"text-blue-500"})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("p",{className:"text-lg font-medium ",children:"Booking Status:"}),s.jsx("p",{className:`font-semibold ${U(e==null?void 0:e.bookingStatus)}`,children:e==null?void 0:e.bookingStatus})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("p",{className:"text-lg font-medium ",children:"GST:"}),s.jsx("p",{className:"text-sm ",children:"18%"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("p",{className:"text-lg font-semibold ",children:"Amount Paid"}),s.jsxs("p",{className:"text-base",children:["₹",e==null?void 0:e.totalAmount]})]})]}),e!=null&&e.foodStatus&&r.length?s.jsxs("div",{className:"col-span-6 space-y-3",children:[s.jsx("h1",{className:"text-xl font-semibold  border-b",children:"Pre orders"}),s.jsxs("ul",{className:"grid grid-rows-4  whitespace-nowrap",children:[r.map(t=>s.jsxs("li",{className:"w-full flex items-center gap-2  bg-white rounded-md",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900 w-36",children:t.itemId.name}),s.jsxs("span",{className:"px-2 text-gray-800 font-semibold",children:["x ",t.quantity]}),s.jsxs("p",{className:"text-sm text-gray-900 ",children:["₹ ",t.price*t.quantity]})]},t._id)),s.jsxs("p",{className:"font-semibold text-lg",children:["Total: ₹ ",M]})]}),s.jsx(K,{cookingStatus:e.foodStatus})]}):null]}),s.jsxs("div",{className:"flex flex-col gap-2 md:flex-row items-center justify-center mt-8",children:[s.jsx(g,{label:`Chat with ${(b=e==null?void 0:e.restaurantId)==null?void 0:b.restaurantName}`,className:"block  bg-blue-400 hover:bg-blue-500 text-white font-semibold py-2 px-4 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-600 focus:ring-opacity-50",handleButtonclick:d}),(e==null?void 0:e.bookingStatus)&&(e==null?void 0:e.foodStatus)==="Accepted"&&!P.includes((e==null?void 0:e.bookingStatus)??"")&&s.jsxs("button",{className:`bg-teal-400 hover:bg-teal-500  inline-flex gap-1 items-center
              text-white font-semibold py-2 px-4 rounded-lg 
              `,onClick:()=>o(`/cart/${n}`),children:[r.length?"Edit your order":"Have something on mind ?",s.jsx(C,{className:"h-4 w-4"})]}),(e==null?void 0:e.bookingStatus)&&(e==null?void 0:e.bookingStatus)==="Confirmed"&&!e.foodStatus&&s.jsx(g,{label:"Cancel Booking",className:"block  bg-red-400 hover:bg-red-500 text-white font-semibold py-2 px-4 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-600 focus:ring-opacity-50",handleButtonclick:()=>m(!0)})]})]}),x&&s.jsx(H,{setIsOpen:m,handleConfirmation:f,action:"cancelBooking"}),!I&&i&&e&&e.bookingStatus==="Completed"&&s.jsx(X,{restaurantId:e==null?void 0:e.restaurantId._id,restauranName:e==null?void 0:e.restaurantId.restaurantName})]})};export{fe as default};
