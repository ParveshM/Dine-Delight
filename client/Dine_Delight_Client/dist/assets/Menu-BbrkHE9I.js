import{r as b,j as n,K as se,O as re,P as ne,Q as ae,R as L,S as oe,q as z,e as le,T as ie}from"./index-Brk7qNXk.js";import{a as ce}from"./util-CjAuLnj4.js";import{a as de,b as q}from"./index-DfupimY1.js";import{a as T}from"./axiosService-lkbGS7qO.js";import{s as _}from"./toaster-CS37tbY2.js";import{B as H}from"./Button-mnL3ev48.js";import{u as ue}from"./formik.esm-D5qv_kgt.js";import{c as he,a as fe,b as V,d as ge}from"./index.esm-DYuc0PpU.js";import{C as me}from"./UploadwidgetContext-a9BiklCO.js";import{C as pe}from"./cooking-pot-CZJFCnjL.js";import{C as xe}from"./ConfirmationModal-JAPsw3sP.js";import{l as be}from"./index-DS0wteeP.js";import{M as Y}from"./MenuItemsShimmer-DpW7DvEg.js";import{u as ye}from"./uploadImages-JufYTW9S.js";import"./axios-B6xwUs71.js";import"./index-VWaDGczM.js";import"./logout-CXkILSTK.js";const we=({name:d,price:l,isVegetarian:i,category:r,tags:h,discount:c,image:f,handleClick:m},e)=>{const t=ce(l,c);return n.jsxs("div",{className:"relative bg-blue-100 hover:bg-blue-200 border border-blue-300 rounded-md p-4",ref:e,children:[n.jsxs("div",{className:"relative ",children:[f&&n.jsx("img",{src:f,alt:"Food",className:"w-full h-auto rounded-md"}),(r==="main course"||r==="starters")&&n.jsx(n.Fragment,{children:i?n.jsx("div",{className:"flex justify-center items-center w-5 h-5  border border-green-500 p-1  mt-2",children:n.jsx(se,{className:"text-green-500"})}):n.jsx("div",{className:"flex justify-center items-center w-5 h-5  border border-red-500 p-1 mt-2",children:n.jsx(de,{className:"text-red-500"})})}),c>0&&n.jsxs("div",{className:"absolute top-1 left-2 bg-yellow-400 text-yellow-900 py-1 px-2 rounded-md text-xs font-semibold flex items-center",children:[n.jsx(re,{className:"w-4 h-4"}),c,"%"]})]}),n.jsxs("div",{className:"",children:[n.jsx("h3",{className:"text-lg font-semibold break-words",children:d}),n.jsxs("p",{className:"text-sm text-gray-600 mt-2 inline-flex gap-1",children:[c>0&&n.jsxs("del",{children:["₹",l]}),"₹",t]})]}),h!=null&&h.length?n.jsx("div",{className:"flex flex-wrap gap-1",children:h==null?void 0:h.map((s,a)=>n.jsx("span",{className:"px-3 py-2 rounded-md text-sm shadow-sm font-medium bg-blue-100 text-blue-800 mr-2",children:s},`${a}-${s}`))}):null,n.jsxs("div",{className:"absolute bottom-2 right-2 flex gap-2",children:[n.jsx(ne,{className:"w-5 h-5 cursor-pointer",onClick:()=>m("Edit")}),n.jsx(ae,{className:"w-5 h-5 cursor-pointer",onClick:()=>m("Delete")})]})]})},G=b.forwardRef(we),Ne=(d=5)=>{const[l,i]=b.useState([]);return{tags:l,setTags:i,handleAddTag:c=>{c&&!l.includes(c.trim())&&l.length<d&&i([...l,c])},handleRemoveTag:c=>i(l.filter(f=>f!==c))}},Ee=({tags:d,addTag:l,removeTag:i,maxTags:r})=>{const[h,c]=b.useState(" "),f=e=>{c(e.target.value)},m=e=>{e.key==="Enter"&&(e.preventDefault(),h.trim()!==""&&h.length<=12&&d.length<r&&(l(h),c("")))};return n.jsxs("div",{className:"flex flex-col",children:[n.jsx("input",{name:"keyword_tags",type:"text",placeholder:d.length<r?"Add a tag":`You can only enter max. of ${r} tags`,className:"w-full border border-gray-300 rounded-md px-4 py-2 outline-none focus:ring-blue-500 focus:border-blue-500",onKeyDown:m,onChange:f,value:h,disabled:d.length===r}),n.jsx("div",{className:"flex flex-row flex-wrap gap-3 mt-4",children:d.map((e,t)=>n.jsxs("span",{className:"inline-flex items-start justify-start px-3 py-2 rounded-[32px] text-sm shadow-sm font-medium bg-blue-100 text-blue-800 mr-2",children:[e,n.jsx("button",{className:"ml-2 hover:text-blue-500",onClick:()=>i(e),title:`Remove ${e}`,children:"×"})]},`${t}-${e}`))})]})},ve=he().shape({name:fe().required("Name is required").matches(/^[A-Z][a-zA-Z0-9\s-]+$/,"Name must start with a capital letter & no symbols"),price:V().required("Price is required").min(1,"Enter a valid price"),discount:V().min(0,"Enter a valid discount").max(50,"Enter discount between 1-50"),notifyUsers:ge().test("testDiscount","Discount must be greater than 0 ",function(d){return!d||d&&this.parent.discount>=1})}),K=({action:d,setIsModalOpen:l,handleItemAdd:i,menuItem:r})=>{const[h,c]=b.useState(!1),{tags:f,setTags:m,handleAddTag:e,handleRemoveTag:t}=Ne(),[s,a]=b.useState((r==null?void 0:r.image)||"");b.useEffect(()=>{r!=null&&r.tags&&m(r==null?void 0:r.tags)},[]);const o=ue({initialValues:{name:(r==null?void 0:r.name)||"",price:(r==null?void 0:r.price)||"",image:(r==null?void 0:r.image)||"",isVegetarian:(r==null?void 0:r.isVegetarian)||!1,category:(r==null?void 0:r.category)||"starters",tags:(r==null?void 0:r.tags)||[],discount:(r==null?void 0:r.discount)||"",notifyUsers:!1},validationSchema:ve,onSubmit:g=>{g.tags=f,c(!0),d==="Add"?T.post(L+"/menu/add",g).then(({data:u})=>{i&&i(u.menuItem,d),_(u.message),l(!1)}).catch(({response:u})=>_(u.data.message,"error")).finally(()=>c(!1)):T.put(L+`/menu/edit/${r==null?void 0:r._id}`,g).then(({data:u})=>{i&&i(u.menuItem,d),_(u.message),l(!1)}).catch(({response:u})=>_(u.data.message,"error")).finally(()=>c(!1))}});return b.useEffect(()=>{o.values.image=s},[s]),n.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto bg-gray-500 bg-opacity-50 flex justify-center items-center ",children:n.jsxs("div",{className:"relative bg-white rounded-lg shadow-lg max-w-md w-full mx-3",children:[n.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[n.jsxs("h3",{className:"text-lg font-semibold text-gray-900 inline-flex items-center gap-2",children:[d==="Add"?"Add":"Edit"," Item",n.jsx(pe,{className:"text-orange-400 text-2xl"})]}),n.jsx("button",{type:"button",className:"text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto flex justify-center items-center",onClick:()=>l(!1),children:n.jsx(q,{className:"w-6 h-6"})})]}),n.jsxs("form",{className:"p-4 md:p-5",onSubmit:o.handleSubmit,children:[n.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-4",children:[n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{htmlFor:"Dish name",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Dish name"}),n.jsx("input",{type:"text",className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg outline-none block w-full p-2.5 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white ",...o.getFieldProps("name")}),o.errors.name&&o.touched.name&&n.jsx("div",{className:"text-red-500",children:o.errors.name})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{htmlFor:"Dish name",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Price"}),n.jsx("input",{type:"number",className:"bg-gray-50 border app border-gray-300 text-gray-900 text-sm rounded-lg outline-none block w-full p-2.5 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white ",...o.getFieldProps("price")}),o.errors.price&&o.touched.price&&n.jsx("p",{className:"text-red-500",children:o.errors.price})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{htmlFor:"countries",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Select an option"}),n.jsxs("select",{id:"countries",...o.getFieldProps("category"),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg appearance-none outline-none focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",children:[n.jsx("option",{value:"starters",children:"Starters"}),n.jsx("option",{value:"main course",children:"Main course"}),n.jsx("option",{value:"drinks",children:"Drink"}),n.jsx("option",{value:"dessert",children:"Dessert"})]})]}),d==="Add"||d==="Edit"&&((r==null?void 0:r.category)==="starters"||(r==null?void 0:r.category)==="main course")?n.jsx("div",{className:"col-span-2 mt-8",children:n.jsxs("label",{className:"inline-flex items-center gap-2",children:[n.jsx("input",{type:"checkbox",className:"form-checkbox h-5 w-5 text-blue-600",checked:o==null?void 0:o.values.isVegetarian,...o.getFieldProps("isVegetarian")}),n.jsx("span",{children:"isveg"})]})}):null,n.jsxs("div",{className:"col-span-4 flex justify-between items-center gap-1 p-4  bg-gray-100 rounded-md ",children:[n.jsx("p",{className:"text-base font-medium",children:"Add Image"}),s&&n.jsx("img",{src:s,alt:"image preview",className:"rounded-md",style:{maxHeight:"100px",maxWidth:"100px"}}),n.jsx(me,{uwConfig:oe,setImageUrl:a})]}),n.jsxs("div",{className:"col-span-2 mt-2",children:[n.jsx("label",{htmlFor:"Discount",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Discount"}),n.jsxs("div",{className:"relative ",children:[n.jsx("input",{type:"number",className:"bg-gray-50 border app border-gray-300 text-gray-900 text-sm rounded-lg outline-none block w-full p-2.5 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white ",...o.getFieldProps("discount")}),n.jsx("span",{className:"absolute inset-y-0 right-0 flex items-center pr-2 text-gray-500 dark:text-gray-400",children:"%"})]}),o.errors.discount&&o.touched.discount&&n.jsx("p",{className:"text-red-500",children:o.errors.discount})]}),n.jsxs("div",{className:"col-span-2 mt-10",children:[n.jsxs("label",{className:"inline-flex items-center gap-2",children:[n.jsx("input",{type:"checkbox",className:"form-checkbox h-5 w-5 text-blue-600",checked:o==null?void 0:o.values.notifyUsers,...o.getFieldProps("notifyUsers")}),n.jsx("span",{children:"Notify users by email"})]}),o.errors.notifyUsers&&o.touched.notifyUsers&&n.jsx("p",{className:"text-red-500",children:o.errors.notifyUsers})]}),n.jsxs("div",{className:"col-span-4 ",children:[n.jsx("label",{htmlFor:"tags",className:"mb-4",children:"Tags"}),n.jsx(Ee,{tags:f,addTag:e,removeTag:t,maxTags:5})]})]}),n.jsx("button",{className:`text-white w-full  bg-green-500 hover:bg-green-600
             focus:ring-green-400 focus:ring-2 focus:outline-none  font-medium rounded-lg
             text-sm px-5 py-2.5 text-center`,type:"submit",disabled:h,children:h?d==="Add"?"Adding...":"Updating":d==="Add"?"Add":"Update"})]})]})})};var Ce=Object.defineProperty,I=Object.getOwnPropertySymbols,Z=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable,W=(d,l,i)=>l in d?Ce(d,l,{enumerable:!0,configurable:!0,writable:!0,value:i}):d[l]=i,X=(d,l)=>{for(var i in l||(l={}))Z.call(l,i)&&W(d,i,l[i]);if(I)for(var i of I(l))J.call(l,i)&&W(d,i,l[i]);return d},Me=(d,l)=>{var i={};for(var r in d)Z.call(d,r)&&l.indexOf(r)<0&&(i[r]=d[r]);if(d!=null&&I)for(var r of I(d))l.indexOf(r)<0&&J.call(d,r)&&(i[r]=d[r]);return i};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var P;(d=>{const l=class{constructor(e,t,s,a){if(this.version=e,this.errorCorrectionLevel=t,this.modules=[],this.isFunction=[],e<l.MIN_VERSION||e>l.MAX_VERSION)throw new RangeError("Version value out of range");if(a<-1||a>7)throw new RangeError("Mask value out of range");this.size=e*4+17;let o=[];for(let u=0;u<this.size;u++)o.push(!1);for(let u=0;u<this.size;u++)this.modules.push(o.slice()),this.isFunction.push(o.slice());this.drawFunctionPatterns();const g=this.addEccAndInterleave(s);if(this.drawCodewords(g),a==-1){let u=1e9;for(let y=0;y<8;y++){this.applyMask(y),this.drawFormatBits(y);const x=this.getPenaltyScore();x<u&&(a=y,u=x),this.applyMask(y)}}c(0<=a&&a<=7),this.mask=a,this.applyMask(a),this.drawFormatBits(a),this.isFunction=[]}static encodeText(e,t){const s=d.QrSegment.makeSegments(e);return l.encodeSegments(s,t)}static encodeBinary(e,t){const s=d.QrSegment.makeBytes(e);return l.encodeSegments([s],t)}static encodeSegments(e,t,s=1,a=40,o=-1,g=!0){if(!(l.MIN_VERSION<=s&&s<=a&&a<=l.MAX_VERSION)||o<-1||o>7)throw new RangeError("Invalid value");let u,y;for(u=s;;u++){const p=l.getNumDataCodewords(u,t)*8,N=m.getTotalBits(e,u);if(N<=p){y=N;break}if(u>=a)throw new RangeError("Data too long")}for(const p of[l.Ecc.MEDIUM,l.Ecc.QUARTILE,l.Ecc.HIGH])g&&y<=l.getNumDataCodewords(u,p)*8&&(t=p);let x=[];for(const p of e){r(p.mode.modeBits,4,x),r(p.numChars,p.mode.numCharCountBits(u),x);for(const N of p.getData())x.push(N)}c(x.length==y);const j=l.getNumDataCodewords(u,t)*8;c(x.length<=j),r(0,Math.min(4,j-x.length),x),r(0,(8-x.length%8)%8,x),c(x.length%8==0);for(let p=236;x.length<j;p^=253)r(p,8,x);let C=[];for(;C.length*8<x.length;)C.push(0);return x.forEach((p,N)=>C[N>>>3]|=p<<7-(N&7)),new l(u,t,C,o)}getModule(e,t){return 0<=e&&e<this.size&&0<=t&&t<this.size&&this.modules[t][e]}getModules(){return this.modules}drawFunctionPatterns(){for(let s=0;s<this.size;s++)this.setFunctionModule(6,s,s%2==0),this.setFunctionModule(s,6,s%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const e=this.getAlignmentPatternPositions(),t=e.length;for(let s=0;s<t;s++)for(let a=0;a<t;a++)s==0&&a==0||s==0&&a==t-1||s==t-1&&a==0||this.drawAlignmentPattern(e[s],e[a]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(e){const t=this.errorCorrectionLevel.formatBits<<3|e;let s=t;for(let o=0;o<10;o++)s=s<<1^(s>>>9)*1335;const a=(t<<10|s)^21522;c(a>>>15==0);for(let o=0;o<=5;o++)this.setFunctionModule(8,o,h(a,o));this.setFunctionModule(8,7,h(a,6)),this.setFunctionModule(8,8,h(a,7)),this.setFunctionModule(7,8,h(a,8));for(let o=9;o<15;o++)this.setFunctionModule(14-o,8,h(a,o));for(let o=0;o<8;o++)this.setFunctionModule(this.size-1-o,8,h(a,o));for(let o=8;o<15;o++)this.setFunctionModule(8,this.size-15+o,h(a,o));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let e=this.version;for(let s=0;s<12;s++)e=e<<1^(e>>>11)*7973;const t=this.version<<12|e;c(t>>>18==0);for(let s=0;s<18;s++){const a=h(t,s),o=this.size-11+s%3,g=Math.floor(s/3);this.setFunctionModule(o,g,a),this.setFunctionModule(g,o,a)}}drawFinderPattern(e,t){for(let s=-4;s<=4;s++)for(let a=-4;a<=4;a++){const o=Math.max(Math.abs(a),Math.abs(s)),g=e+a,u=t+s;0<=g&&g<this.size&&0<=u&&u<this.size&&this.setFunctionModule(g,u,o!=2&&o!=4)}}drawAlignmentPattern(e,t){for(let s=-2;s<=2;s++)for(let a=-2;a<=2;a++)this.setFunctionModule(e+a,t+s,Math.max(Math.abs(a),Math.abs(s))!=1)}setFunctionModule(e,t,s){this.modules[t][e]=s,this.isFunction[t][e]=!0}addEccAndInterleave(e){const t=this.version,s=this.errorCorrectionLevel;if(e.length!=l.getNumDataCodewords(t,s))throw new RangeError("Invalid argument");const a=l.NUM_ERROR_CORRECTION_BLOCKS[s.ordinal][t],o=l.ECC_CODEWORDS_PER_BLOCK[s.ordinal][t],g=Math.floor(l.getNumRawDataModules(t)/8),u=a-g%a,y=Math.floor(g/a);let x=[];const j=l.reedSolomonComputeDivisor(o);for(let p=0,N=0;p<a;p++){let v=e.slice(N,N+y-o+(p<u?0:1));N+=v.length;const S=l.reedSolomonComputeRemainder(v,j);p<u&&v.push(0),x.push(v.concat(S))}let C=[];for(let p=0;p<x[0].length;p++)x.forEach((N,v)=>{(p!=y-o||v>=u)&&C.push(N[p])});return c(C.length==g),C}drawCodewords(e){if(e.length!=Math.floor(l.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let t=0;for(let s=this.size-1;s>=1;s-=2){s==6&&(s=5);for(let a=0;a<this.size;a++)for(let o=0;o<2;o++){const g=s-o,y=(s+1&2)==0?this.size-1-a:a;!this.isFunction[y][g]&&t<e.length*8&&(this.modules[y][g]=h(e[t>>>3],7-(t&7)),t++)}}c(t==e.length*8)}applyMask(e){if(e<0||e>7)throw new RangeError("Mask value out of range");for(let t=0;t<this.size;t++)for(let s=0;s<this.size;s++){let a;switch(e){case 0:a=(s+t)%2==0;break;case 1:a=t%2==0;break;case 2:a=s%3==0;break;case 3:a=(s+t)%3==0;break;case 4:a=(Math.floor(s/3)+Math.floor(t/2))%2==0;break;case 5:a=s*t%2+s*t%3==0;break;case 6:a=(s*t%2+s*t%3)%2==0;break;case 7:a=((s+t)%2+s*t%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[t][s]&&a&&(this.modules[t][s]=!this.modules[t][s])}}getPenaltyScore(){let e=0;for(let o=0;o<this.size;o++){let g=!1,u=0,y=[0,0,0,0,0,0,0];for(let x=0;x<this.size;x++)this.modules[o][x]==g?(u++,u==5?e+=l.PENALTY_N1:u>5&&e++):(this.finderPenaltyAddHistory(u,y),g||(e+=this.finderPenaltyCountPatterns(y)*l.PENALTY_N3),g=this.modules[o][x],u=1);e+=this.finderPenaltyTerminateAndCount(g,u,y)*l.PENALTY_N3}for(let o=0;o<this.size;o++){let g=!1,u=0,y=[0,0,0,0,0,0,0];for(let x=0;x<this.size;x++)this.modules[x][o]==g?(u++,u==5?e+=l.PENALTY_N1:u>5&&e++):(this.finderPenaltyAddHistory(u,y),g||(e+=this.finderPenaltyCountPatterns(y)*l.PENALTY_N3),g=this.modules[x][o],u=1);e+=this.finderPenaltyTerminateAndCount(g,u,y)*l.PENALTY_N3}for(let o=0;o<this.size-1;o++)for(let g=0;g<this.size-1;g++){const u=this.modules[o][g];u==this.modules[o][g+1]&&u==this.modules[o+1][g]&&u==this.modules[o+1][g+1]&&(e+=l.PENALTY_N2)}let t=0;for(const o of this.modules)t=o.reduce((g,u)=>g+(u?1:0),t);const s=this.size*this.size,a=Math.ceil(Math.abs(t*20-s*10)/s)-1;return c(0<=a&&a<=9),e+=a*l.PENALTY_N4,c(0<=e&&e<=2568888),e}getAlignmentPatternPositions(){if(this.version==1)return[];{const e=Math.floor(this.version/7)+2,t=this.version==32?26:Math.ceil((this.version*4+4)/(e*2-2))*2;let s=[6];for(let a=this.size-7;s.length<e;a-=t)s.splice(1,0,a);return s}}static getNumRawDataModules(e){if(e<l.MIN_VERSION||e>l.MAX_VERSION)throw new RangeError("Version number out of range");let t=(16*e+128)*e+64;if(e>=2){const s=Math.floor(e/7)+2;t-=(25*s-10)*s-55,e>=7&&(t-=36)}return c(208<=t&&t<=29648),t}static getNumDataCodewords(e,t){return Math.floor(l.getNumRawDataModules(e)/8)-l.ECC_CODEWORDS_PER_BLOCK[t.ordinal][e]*l.NUM_ERROR_CORRECTION_BLOCKS[t.ordinal][e]}static reedSolomonComputeDivisor(e){if(e<1||e>255)throw new RangeError("Degree out of range");let t=[];for(let a=0;a<e-1;a++)t.push(0);t.push(1);let s=1;for(let a=0;a<e;a++){for(let o=0;o<t.length;o++)t[o]=l.reedSolomonMultiply(t[o],s),o+1<t.length&&(t[o]^=t[o+1]);s=l.reedSolomonMultiply(s,2)}return t}static reedSolomonComputeRemainder(e,t){let s=t.map(a=>0);for(const a of e){const o=a^s.shift();s.push(0),t.forEach((g,u)=>s[u]^=l.reedSolomonMultiply(g,o))}return s}static reedSolomonMultiply(e,t){if(e>>>8||t>>>8)throw new RangeError("Byte out of range");let s=0;for(let a=7;a>=0;a--)s=s<<1^(s>>>7)*285,s^=(t>>>a&1)*e;return c(s>>>8==0),s}finderPenaltyCountPatterns(e){const t=e[1];c(t<=this.size*3);const s=t>0&&e[2]==t&&e[3]==t*3&&e[4]==t&&e[5]==t;return(s&&e[0]>=t*4&&e[6]>=t?1:0)+(s&&e[6]>=t*4&&e[0]>=t?1:0)}finderPenaltyTerminateAndCount(e,t,s){return e&&(this.finderPenaltyAddHistory(t,s),t=0),t+=this.size,this.finderPenaltyAddHistory(t,s),this.finderPenaltyCountPatterns(s)}finderPenaltyAddHistory(e,t){t[0]==0&&(e+=this.size),t.pop(),t.unshift(e)}};let i=l;i.MIN_VERSION=1,i.MAX_VERSION=40,i.PENALTY_N1=3,i.PENALTY_N2=3,i.PENALTY_N3=40,i.PENALTY_N4=10,i.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],i.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],d.QrCode=i;function r(e,t,s){if(t<0||t>31||e>>>t)throw new RangeError("Value out of range");for(let a=t-1;a>=0;a--)s.push(e>>>a&1)}function h(e,t){return(e>>>t&1)!=0}function c(e){if(!e)throw new Error("Assertion error")}const f=class{constructor(e,t,s){if(this.mode=e,this.numChars=t,this.bitData=s,t<0)throw new RangeError("Invalid argument");this.bitData=s.slice()}static makeBytes(e){let t=[];for(const s of e)r(s,8,t);return new f(f.Mode.BYTE,e.length,t)}static makeNumeric(e){if(!f.isNumeric(e))throw new RangeError("String contains non-numeric characters");let t=[];for(let s=0;s<e.length;){const a=Math.min(e.length-s,3);r(parseInt(e.substr(s,a),10),a*3+1,t),s+=a}return new f(f.Mode.NUMERIC,e.length,t)}static makeAlphanumeric(e){if(!f.isAlphanumeric(e))throw new RangeError("String contains unencodable characters in alphanumeric mode");let t=[],s;for(s=0;s+2<=e.length;s+=2){let a=f.ALPHANUMERIC_CHARSET.indexOf(e.charAt(s))*45;a+=f.ALPHANUMERIC_CHARSET.indexOf(e.charAt(s+1)),r(a,11,t)}return s<e.length&&r(f.ALPHANUMERIC_CHARSET.indexOf(e.charAt(s)),6,t),new f(f.Mode.ALPHANUMERIC,e.length,t)}static makeSegments(e){return e==""?[]:f.isNumeric(e)?[f.makeNumeric(e)]:f.isAlphanumeric(e)?[f.makeAlphanumeric(e)]:[f.makeBytes(f.toUtf8ByteArray(e))]}static makeEci(e){let t=[];if(e<0)throw new RangeError("ECI assignment value out of range");if(e<128)r(e,8,t);else if(e<16384)r(2,2,t),r(e,14,t);else if(e<1e6)r(6,3,t),r(e,21,t);else throw new RangeError("ECI assignment value out of range");return new f(f.Mode.ECI,0,t)}static isNumeric(e){return f.NUMERIC_REGEX.test(e)}static isAlphanumeric(e){return f.ALPHANUMERIC_REGEX.test(e)}getData(){return this.bitData.slice()}static getTotalBits(e,t){let s=0;for(const a of e){const o=a.mode.numCharCountBits(t);if(a.numChars>=1<<o)return 1/0;s+=4+o+a.bitData.length}return s}static toUtf8ByteArray(e){e=encodeURI(e);let t=[];for(let s=0;s<e.length;s++)e.charAt(s)!="%"?t.push(e.charCodeAt(s)):(t.push(parseInt(e.substr(s+1,2),16)),s+=2);return t}};let m=f;m.NUMERIC_REGEX=/^[0-9]*$/,m.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,m.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",d.QrSegment=m})(P||(P={}));(d=>{(l=>{const i=class{constructor(h,c){this.ordinal=h,this.formatBits=c}};let r=i;r.LOW=new i(0,1),r.MEDIUM=new i(1,0),r.QUARTILE=new i(2,3),r.HIGH=new i(3,2),l.Ecc=r})(d.QrCode||(d.QrCode={}))})(P||(P={}));(d=>{(l=>{const i=class{constructor(h,c){this.modeBits=h,this.numBitsCharCount=c}numCharCountBits(h){return this.numBitsCharCount[Math.floor((h+7)/17)]}};let r=i;r.NUMERIC=new i(1,[10,12,14]),r.ALPHANUMERIC=new i(2,[9,11,13]),r.BYTE=new i(4,[8,16,16]),r.KANJI=new i(8,[8,10,12]),r.ECI=new i(7,[0,0,0]),l.Mode=r})(d.QrSegment||(d.QrSegment={}))})(P||(P={}));var D=P;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var je={L:D.QrCode.Ecc.LOW,M:D.QrCode.Ecc.MEDIUM,Q:D.QrCode.Ecc.QUARTILE,H:D.QrCode.Ecc.HIGH},Ae=128,Re="L",Se="#FFFFFF",_e="#000000",Pe=!1,ee=4,ke=.1;function Fe(d,l=0){const i=[];return d.forEach(function(r,h){let c=null;r.forEach(function(f,m){if(!f&&c!==null){i.push(`M${c+l} ${h+l}h${m-c}v1H${c+l}z`),c=null;return}if(m===r.length-1){if(!f)return;c===null?i.push(`M${m+l},${h+l} h1v1H${m+l}z`):i.push(`M${c+l},${h+l} h${m+1-c}v1H${c+l}z`);return}f&&c===null&&(c=m)})}),i.join("")}function Oe(d,l){return d.slice().map((i,r)=>r<l.y||r>=l.y+l.h?i:i.map((h,c)=>c<l.x||c>=l.x+l.w?h:!1))}function De(d,l,i,r){if(r==null)return null;const h=i?ee:0,c=d.length+h*2,f=Math.floor(l*ke),m=c/l,e=(r.width||f)*m,t=(r.height||f)*m,s=r.x==null?d.length/2-e/2:r.x*m,a=r.y==null?d.length/2-t/2:r.y*m;let o=null;if(r.excavate){let g=Math.floor(s),u=Math.floor(a),y=Math.ceil(e+s-g),x=Math.ceil(t+a-u);o={x:g,y:u,w:y,h:x}}return{x:s,y:a,h:t,w:e,excavation:o}}var Le=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}();function Te(d){const l=d,{value:i,size:r=Ae,level:h=Re,bgColor:c=Se,fgColor:f=_e,includeMargin:m=Pe,style:e,imageSettings:t}=l,s=Me(l,["value","size","level","bgColor","fgColor","includeMargin","style","imageSettings"]),a=t==null?void 0:t.src,o=b.useRef(null),g=b.useRef(null),[u,y]=b.useState(!1);b.useEffect(()=>{if(o.current!=null){const C=o.current,p=C.getContext("2d");if(!p)return;let N=D.QrCode.encodeText(i,je[h]).getModules();const v=m?ee:0,S=N.length+v*2,A=De(N,r,m,t),R=g.current,F=A!=null&&R!==null&&R.complete&&R.naturalHeight!==0&&R.naturalWidth!==0;F&&A.excavation!=null&&(N=Oe(N,A.excavation));const O=window.devicePixelRatio||1;C.height=C.width=r*O;const U=r/S*O;p.scale(U,U),p.fillStyle=c,p.fillRect(0,0,S,S),p.fillStyle=f,Le?p.fill(new Path2D(Fe(N,v))):N.forEach(function(k,Q){k.forEach(function(B,$){B&&p.fillRect($+v,Q+v,1,1)})}),F&&p.drawImage(R,A.x+v,A.y+v,A.w,A.h)}}),b.useEffect(()=>{y(!1)},[a]);const x=X({height:r,width:r},e);let j=null;return a!=null&&(j=z.createElement("img",{src:a,key:a,style:{display:"none"},onLoad:()=>{y(!0)},ref:g})),z.createElement(z.Fragment,null,z.createElement("canvas",X({style:x,height:r,width:r,ref:o},s)),j)}const Ue=({setIsModalOpen:d})=>{const{id:l}=le(c=>c.UserSlice),[i]=b.useState(`http://localhost:3000/menu/${l}`),r=b.useRef(null),h=async()=>{const c=document.getElementById("qrCodeEl");if(c){c.toBlob(async e=>{if(e){const s=await ye([e]);T.put(L+"/info",{qrCode:s[0]}).then(()=>{_("Qr saved successfully")}).catch(a=>console.log(a))}},"image/png");const f=c.toDataURL("image/png").replace("image/png","image/octet-stream");let m=document.createElement("a");m.href=f,m.download="QR_Code.png",document.body.appendChild(m),m.click(),document.body.removeChild(m)}};return b.useEffect(()=>{const c=f=>{!r.current||r.current.contains(f.target)||d(!1)};return document.addEventListener("mousedown",c),()=>{document.removeEventListener("mousedown",c)}},[r]),n.jsx("div",{className:"fixed inset-0 z-50  overflow-y-auto bg-gray-500 bg-opacity-50 flex justify-center items-center ",children:n.jsxs("div",{className:"relative bg-white rounded-lg shadow-lg max-w-md w-full mx-3 sm:top-7",ref:r,onClick:c=>c.stopPropagation(),children:[n.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 inline-flex items-center gap-2",children:"Qrcode for Menu"}),n.jsx("button",{type:"button",className:"text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto flex justify-center items-center",onClick:()=>d(!1),children:n.jsx(q,{className:"w-6 h-6"})})]}),n.jsxs("div",{className:"p-4 md:p-5",children:[n.jsx("div",{className:"grid grid-cols-4 space-y-2 mb-2",children:i.length?n.jsx("div",{className:"col-span-4 flex justify-center",children:n.jsx(Te,{id:"qrCodeEl",size:150,value:i.trim()})}):null}),n.jsx(H,{className:`w-full   bg-green-500 hover:bg-green-600
          focus:ring-green-400 focus:ring-2 focus:outline-none  font-medium rounded-lg
          `,buttontype:"button",label:"Download & Save ",handleButtonclick:h})]})]})})},st=()=>{const[d,l]=b.useState(""),[i,r]=b.useState(!1),[h,c]=b.useState("starters"),[f,m]=b.useState([]),[e,t]=b.useState(null),[s,a]=b.useState(null),[o,g]=b.useState(!1),[u,y]=b.useState(!1),[x,j]=b.useState(!1),[C,p]=b.useState(!1),[N,v]=b.useState(!1),[S,A]=b.useState(!1),[R,F]=b.useState(1),[O,U]=b.useState(!1),k=b.useRef(),Q=b.useCallback(w=>{N||S||(k.current&&k.current.disconnect(),k.current=new IntersectionObserver(E=>{E[0].isIntersecting&&O&&F(M=>M+1)}),w&&k.current.observe(w))},[N,S,O]),B=(w,E)=>{if(h&&w.category===h)if(E==="Add")i&&w.isVegetarian?m(M=>[...M,w]):!w.isVegetarian&&m(M=>[...M,w]);else{const M=f.filter(te=>te._id!==w._id);M.unshift(w),m(M),t(null)}},$=()=>{if(s){const w=f.filter(E=>E._id!==s._id);m(w),p(!1),T.delete(L+`/menu/delete/${s._id}`).then(({data:E})=>_(E.message)).catch(()=>_("Oops! Something went wrong","error"))}};return b.useEffect(()=>{m([]),F(1)},[h,i,d]),b.useEffect(()=>{R>1?A(!0):v(!0),T.get(L+"/menu",{params:{q:d,page:R,category:h,...i&&{isVegetarian:i}}}).then(({data:w})=>{var E;m(M=>[...M,...w.menu]),U(((E=w.menu)==null?void 0:E.length)>0),R>1?A(!1):v(!1)}).catch(()=>_("Oops! Something went wrong","error"))},[h,d,i,R]),n.jsxs("div",{className:"grid grid-cols-8 gap-8",children:[n.jsxs("div",{className:"col-span-5 md:col-span-6 space-y-8 ",children:[n.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-2  mb-3",children:[n.jsx("h1",{className:"text-3xl font-semibold ",children:"Menu"}),n.jsxs("div",{className:"flex item-center gap-2",children:[n.jsx(H,{label:"Qr Code",className:"px-4 py-2 bg-green-400",handleButtonclick:()=>y(!0)}),n.jsx(H,{label:"Add Item",className:"px-4 py-2 bg-yellow-400 ",handleButtonclick:()=>g(!0)})]})]}),n.jsxs("div",{className:" flex items-center gap-2",children:[n.jsx(be.DebounceInput,{min:1,debounceTimeout:500,type:"search",placeholder:"Search...",value:d,onChange:w=>l(w.target.value),className:"px-4 py-2 w-full  border border-gray-300 rounded-xl shadow-sm focus:outline-none focus:border-blue-500"}),(h==="starters"||h==="main course")&&n.jsxs("label",{className:"inline-flex items-center  ",children:[n.jsx("div",{className:`relative w-12 h-6 rounded-full cursor-pointer ${i?"bg-green-500":"bg-gray-300"}`,onClick:()=>r(!i),children:n.jsx("div",{className:`absolute left-1 top-0.5 w-5 h-5 rounded-full bg-white transition-transform ${i?"transform translate-x-full":""}`})}),n.jsx("span",{className:"ml-2",children:"Veg"})]})]}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6 pb-5",children:[h&&n.jsx("h3",{className:"text-xl font-semibold col-span-full uppercase",children:h}),N?n.jsx(n.Fragment,{children:Array.from({length:8}).map((w,E)=>n.jsx(Y,{},E))}):n.jsx(n.Fragment,{children:f.length?n.jsx(n.Fragment,{children:f.map((w,E)=>f.length===E+1?b.createElement(G,{...w,key:w._id,handleClick:M=>{M==="Edit"?(j(!0),t(w)):(a(w),p(!0))},ref:Q}):b.createElement(G,{...w,key:w._id,handleClick:M=>{M==="Edit"?(j(!0),t(w)):(a(w),p(!0))}}))}):n.jsxs("div",{className:"col-span-6 flex flex-col justify-center items-center",children:[n.jsx("h2",{className:"text-2xl  font-bold mb-2",children:"No Items found"}),n.jsx("p",{className:"text-lg  text-gray-600",children:"Sorry, no items found matching your filter."})]})}),S&&Array.from({length:3}).map((w,E)=>n.jsx(Y,{},E))]})]}),n.jsxs("div",{className:" col-span-3 md:col-span-2 space-y-4 sticky top-20 right-0 custom-vh",children:[n.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Categories"}),ie.map((w,E)=>n.jsx("div",{className:` bg-[#000099] hover:bg-[#000080] py-4 rounded-md font-semibold
                      text-white text-center uppercase cursor-pointer`,onClick:()=>c(w),children:w},E))]}),o&&n.jsx(K,{setIsModalOpen:g,handleItemAdd:B,action:"Add"}),x&&e&&n.jsx(K,{setIsModalOpen:j,handleItemAdd:B,action:"Edit",menuItem:e}),C&&s&&n.jsx(xe,{action:"deleteMenuItem",setIsOpen:p,handleConfirmation:$}),u&&n.jsx(Ue,{setIsModalOpen:y})]})};export{st as default};
