import{k as C,r as s,U as N,n as P,j as e,L as E}from"./index-DLCA8CUi.js";import{c as L}from"./index-DS0oADGo.js";import{a as w}from"./axiosService-BUADEq0L.js";import{s as j}from"./toaster-KMB571tZ.js";import{u as F}from"./uploadImages-BWAsXRuM.js";import{d as R}from"./dummyUserImg-Dvp0fbEd.js";import"./axios-B6xwUs71.js";import"./index-VWaDGczM.js";import"./logout-DcSaUvZa.js";import"./Set_GetLs-jfIHgayU.js";/**
 * @license lucide-react v0.341.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=C("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),T=()=>{const[n,t]=s.useState(null),[m,d]=s.useState(null),[u,x]=s.useState([]),[g,i]=s.useState(null),[h,p]=s.useState({name:"",imageFile:[]}),[y,a]=s.useState(null),[S,b]=s.useState(!1),[I,v]=s.useState(!1);return s.useEffect(()=>{w.get(N+"/profile").then(({data:r})=>{const{user:o,wallet:f,transactions:l}=r;t(o),d(f),x(l),p(c=>({...c,name:o.name}))}).catch(()=>j("Oops! Something went wrong","error"))},[]),{profile:n,wallet:m,transactons:u,formData:h,imagePreview:y,error:g,isSubmitting:S,handleInputChange:r=>{const{name:o,value:f}=r.target;let l="";if(o==="name")f.trim()?P.test(f)||(l="First letter must be capital and no leading or trailing space"):l="Name is required",i(l||null),p(c=>({...c,name:f.trim()}));else{const c=Array.from(r.target.files||[]);p(k=>({...k,[o]:c})),a(URL.createObjectURL(c[0]))}},handleSubmit:async()=>{if(!g){b(!0);const r=await F(h.imageFile);w.patch(N+"/profile/edit",{name:h.name,profilePicture:r&&r[0]?r[0]:n==null?void 0:n.profilePicture}).then(({data:o})=>{j(o.message),b(!1),v(!1)}).catch(()=>{b(!1),j("Oops! Something went wrong while updating profile","error")})}},isEditing:I,setIsEditing:v}},B=()=>{const{error:n,profile:t,wallet:m,formData:d,transactons:u,isEditing:x,imagePreview:g,isSubmitting:i,setIsEditing:h,handleSubmit:p,handleInputChange:y}=T();return e.jsxs("div",{className:"grid grid-cols-6 gap-4",children:[e.jsx("div",{className:"col-span-6 md:col-span-3",children:e.jsxs("div",{className:"border shadow-md rounded-md p-10 py-4",children:[e.jsx("div",{className:"flex justify-center  items-center gap-4",children:e.jsxs("div",{className:"relative w-36 h-36    overflow-hidden rounded-full",children:[e.jsx("img",{src:g||((t==null?void 0:t.profilePicture)??R),alt:"Profile",className:"w-full h-full object-cover"}),e.jsxs("label",{htmlFor:"profileImage",className:"absolute bottom-5 right-3 bg-gray-100 rounded-full p-2 cursor-pointer border border-gray-300",children:[e.jsx(O,{}),e.jsx("input",{id:"profileImage",name:"imageFile",type:"file",className:"hidden",accept:"image/*",onChange:y})]})]})}),e.jsxs("div",{className:"flex justify-end gap-2 items-center mt-4",children:[e.jsx("p",{className:"text-base font-semibold",children:"Joining date:"}),e.jsx("p",{children:(t==null?void 0:t.createdAt)&&new Date(t==null?void 0:t.createdAt).toLocaleDateString("en-IN",{day:"2-digit",month:"long",year:"numeric"})})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("input",{type:"text",placeholder:"Name",name:"name",value:d==null?void 0:d.name,onChange:y,className:"border-b-2  border-gray-200  read-only:focus:border-gray-200 focus:border-primary-600 focus:ring-primary-600 outline-none sm:text-sm p-2.5 mb-2",readOnly:!x}),n&&e.jsx("p",{className:"text-red-500",children:n}),e.jsx("input",{type:"text",placeholder:"Email",value:(t==null?void 0:t.email)??"",readOnly:!0,className:"border-b-2 border-gray-200  outline-none sm:text-sm p-2.5"})]}),e.jsx("div",{className:"flex justify-center",children:x?e.jsx("button",{className:`inline-block ${i&&"opacity-100 cursor-wait"} px-4 mt-2 py-2 text-lg font-medium text-white bg-gradient-to-r from-pink-500 to-orange-400 rounded-3xl   transition duration-300 ease-in-out hover:from-pink-600 hover:to-orange-500 focus:outline-none  focus:ring-offset-2`,disabled:i,onClick:p,children:i?"Submitting...":" Save changes"}):e.jsx("button",{className:`inline-block ${i&&"opacity-100 cursor-wait"} px-4 mt-2 py-2 text-lg font-medium text-white bg-gradient-to-r from-pink-500 to-orange-400 rounded-3xl   transition duration-300 ease-in-out hover:from-pink-600 hover:to-orange-500 focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-offset-2`,onClick:()=>h(!0),children:"Edit Profile"})})]})}),e.jsx("div",{className:"col-span-6 md:col-span-2",children:e.jsxs("div",{className:"border shadow-md rounded-md p-4",children:[e.jsxs("div",{className:"flex items-center justify-around mb-4",children:[e.jsxs("div",{className:"flex gap-2 items-center ",children:[e.jsx(L,{className:"h-8 w-8 text-yellow-400"}),e.jsxs("span",{className:"text-gray-600 ml-1",children:["â‚¹",m==null?void 0:m.balance,".00"]})]}),e.jsx(E,{to:"/transaction_history",className:"text-sm text-primary-600 hover:text-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-600",children:"View History"})]}),e.jsxs("div",{className:"space-y-2",children:[u.length?e.jsx("h3",{className:"",children:"Recent Transaction"}):e.jsx("h3",{children:"No recent transactions"}),u.length?u.slice(0,5).map(a=>e.jsxs("div",{className:"flex justify-between items-center bg-gray-100 rounded-md p-2",children:[e.jsx("div",{className:"text-sm text-gray-700",children:a.type}),e.jsx("div",{className:`text-sm font-semibold ${a.type==="Credit"?"text-green-600":"text-red-600"} `,children:a.type==="Credit"?`+${a.amount}`:`-${a.amount}`})]},a._id)):null]})]})})]})};export{B as default};
