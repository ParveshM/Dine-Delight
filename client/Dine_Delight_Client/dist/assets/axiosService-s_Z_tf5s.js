import{a as s}from"./axios-B6xwUs71.js";import{j as n}from"./index-VWaDGczM.js";import{a7 as i}from"./index-DVuvbJIy.js";import{l}from"./logout-CuczN05Q.js";const u=s.create();u.defaults.withCredentials=!0;s.defaults.withCredentials=!0;const c=async()=>{try{await s.post(i+"/refresh_token")}catch{l("Session expired ,please Login")}},d=async()=>{try{let e,o;const{data:t}=await s.get(i+"/accessToken");e=t==null?void 0:t.access_token,o=t==null?void 0:t.user;const r=await n(e),{role:a}=r;return(a==="seller"||a==="user")&&o.isBlocked&&l("Your account has been blocked by administrator","error"),e}catch(e){console.log(e,"Error in getting token")}};u.interceptors.request.use(async e=>{let o=new Date,t;try{const r=await d();if(!r)return await c(),e;t=await n(r)}catch(r){console.log("error in decodeToken"+r)}return t.exp*1e3<o.getTime()&&await c(),e});export{u as a};
