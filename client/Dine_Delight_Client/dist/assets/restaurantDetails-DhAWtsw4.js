import{r,R,l as J,j as e}from"./index-DavhRDW3.js";import{I as L}from"./index-CdR2gUWB.js";import{u as U}from"./uploadImages-CZTCSqFE.js";import{a as k}from"./axiosService-CQ77gCsN.js";import{s as S}from"./toaster-CmwnzG8n.js";import{c as O}from"./validation-l2lErG5t.js";import{g as Z,A as B}from"./reverseGeocode-CFmbwmh4.js";import{C as W}from"./Map-BGp0d3Ls.js";import{C as q}from"./ConfirmationModal-CE820WSC.js";import"./axios-B6xwUs71.js";import"./index-VWaDGczM.js";import"./logout-B-tf4HjF.js";import"./index.esm-C3jo7EpZ.js";import"./index-CowyCNIh.js";import"./index-s4T0ZMbU.js";const z=()=>{const[t,d]=r.useState({restaurantName:"",email:"",address:"",phone:"",description:"",searchLocation:"",openingTime:"",closingTime:"",costForTwo:300,tableRatePerPerson:200,primaryImage:"",secondaryImages:[""],location:{type:"Point",coordinates:["",""]}}),[p,u]=r.useState(null),[a,N]=r.useState([]),[v,h]=r.useState([]),[I,i]=r.useState([]),[f,y]=r.useState(null),[w,b]=r.useState(!1),[C,x]=r.useState(!1),[P,m]=r.useState(!1),[g,A]=r.useState(null);return r.useEffect(()=>{k.get(R+"/info").then(async({data:n})=>{const{location:{coordinates:s}}=n.restaurant,l=await Z(s[0],s[1]);return{restaurant:n.restaurant,code:l}}).then(({restaurant:n,code:s})=>{const{restaurantName:l,email:o,phone:j,address:F,description:D,primaryImage:M,secondaryImages:E,openingTime:_,closingTime:G,tableRatePerPerson:V,location:{coordinates:$}}=n;d(c=>{var T;return{...c,restaurantName:l,email:o,phone:j??c.phone,address:F??c.address,description:D??c.description,primaryImage:M??c.primaryImage,secondaryImages:E??c.secondaryImages,openingTime:_??"09:00",closingTime:G??"21:00",searchLocation:s??c.searchLocation,tableRatePerPerson:V??c.tableRatePerPerson,location:{type:"Point",coordinates:$??((T=c.location)==null?void 0:T.coordinates)??["",""]}}})}).catch(n=>console.log(n))},[]),{formData:t,setFormData:d,imagePreviews:v,featuredImgPreview:f,handleFeaturedImg:n=>{const s=Array.from(n.target.files||[]);i(s);const l=s.map(o=>URL.createObjectURL(o));y(l[0])},handleImageChange:n=>{const s=Array.from(n.target.files||[]);N(s);const l=s.map(o=>URL.createObjectURL(o));h(l)},handleInputChange:n=>{const{name:s,value:l}=n.target,o={...t,[s]:l};d(o);const j=O(o),F=Object.keys(j).length===0;u(F?{}:j)},uploadImages:async(n="coverImage")=>{if(n==="featuredImage"){b(!0);const s=await U(I);d({...t,primaryImage:s[0]}),y(null),b(!1)}else{x(!0);const s=await U(a);d(l=>({...l,secondaryImages:[...l.secondaryImages,...s]})),h([])}x(!1)},handleSubmit:async n=>{n.preventDefault();const s=O(t);Object.keys(s).length===0?k.put(R+"/info",t).then(({data:o})=>{S(o.message)}).catch(o=>console.log(o)):u(s)},isFeauredUploading:w,isUploading:C,updateCoordinates:(n,s)=>{d(l=>({...l,location:{type:"Point",coordinates:[s,n]}}))},errors:p,isModalOpen:P,setIsModalOpen:m,setImageToRemove:A,handleImageRemove:()=>{if(g){const n=t.secondaryImages.filter(s=>s!==g);d(s=>({...s,secondaryImages:n})),m(!1),k.put(R+"/info",{secondaryImages:n}).then(()=>{S("Image removed successfully")}).catch(s=>console.log(s))}}}};function H(t){return J({tag:"svg",attr:{viewBox:"0 0 15 15",fill:"none"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M0.877075 7.49988C0.877075 3.84219 3.84222 0.877045 7.49991 0.877045C11.1576 0.877045 14.1227 3.84219 14.1227 7.49988C14.1227 11.1575 11.1576 14.1227 7.49991 14.1227C3.84222 14.1227 0.877075 11.1575 0.877075 7.49988ZM7.49991 1.82704C4.36689 1.82704 1.82708 4.36686 1.82708 7.49988C1.82708 10.6329 4.36689 13.1727 7.49991 13.1727C10.6329 13.1727 13.1727 10.6329 13.1727 7.49988C13.1727 4.36686 10.6329 1.82704 7.49991 1.82704ZM9.85358 5.14644C10.0488 5.3417 10.0488 5.65829 9.85358 5.85355L8.20713 7.49999L9.85358 9.14644C10.0488 9.3417 10.0488 9.65829 9.85358 9.85355C9.65832 10.0488 9.34173 10.0488 9.14647 9.85355L7.50002 8.2071L5.85358 9.85355C5.65832 10.0488 5.34173 10.0488 5.14647 9.85355C4.95121 9.65829 4.95121 9.3417 5.14647 9.14644L6.79292 7.49999L5.14647 5.85355C4.95121 5.65829 4.95121 5.3417 5.14647 5.14644C5.34173 4.95118 5.65832 4.95118 5.85358 5.14644L7.50002 6.79289L9.14647 5.14644C9.34173 4.95118 9.65832 4.95118 9.85358 5.14644Z",fill:"currentColor"},child:[]}]})(t)}const ye=()=>{const{formData:t,setFormData:d,imagePreviews:p,featuredImgPreview:u,errors:a,isFeauredUploading:N,isUploading:v,handleFeaturedImg:h,handleImageChange:I,handleInputChange:i,uploadImages:f,handleSubmit:y,updateCoordinates:w,setImageToRemove:b,isModalOpen:C,setIsModalOpen:x,handleImageRemove:P}=z();return e.jsxs("div",{className:" sm:flex justify-center items-center",children:[e.jsxs("div",{className:"mt-5 md:mt-0 md:col-span-2",children:[e.jsx("h1",{className:"m-1 font-semibold text-2xl",children:"Restaurant Details"}),e.jsx("form",{onSubmit:y,children:e.jsxs("div",{className:"shadow sm:rounded-md sm:overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-5 bg-white space-y-6 sm:p-6",children:[e.jsxs("div",{className:"grid grid-cols-6 gap-6",children:[e.jsxs("div",{className:"col-span-6 sm:col-span-3",children:[e.jsx("label",{htmlFor:"Restaurant name",className:"block text-sm font-medium text-gray-700",children:"Restaurant name"}),e.jsxs("div",{className:"mt-1 rounded-md shadow-sm",children:[e.jsx("input",{className:"w-full py-3 px-4 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-100",type:"text",name:"restaurantName",onChange:i,value:t.restaurantName}),(a==null?void 0:a.restaurantName)&&e.jsx("p",{className:"text-red-500",children:a==null?void 0:a.restaurantName})]})]}),e.jsxs("div",{className:"col-span-6 sm:col-span-3",children:[e.jsx("label",{htmlFor:"Email",className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("div",{className:"mt-1 flex rounded-md shadow-sm",children:e.jsx("input",{className:"w-full py-3 px-4 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",type:"text",name:"email yfvi",value:t.email,readOnly:!0})})]}),e.jsxs("div",{className:"col-span-6 sm:col-span-3",children:[e.jsx("label",{htmlFor:"Address",className:"block text-sm font-medium text-gray-700",children:"Address"}),e.jsx("div",{className:"mt-1 flex rounded-md shadow-sm",children:e.jsx("input",{className:"w-full py-3 px-4 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",type:"text",name:"address",onChange:i,value:t.address})}),(a==null?void 0:a.address)&&e.jsx("p",{className:"text-red-500",children:a==null?void 0:a.address})]}),e.jsxs("div",{className:"col-span-6 sm:col-span-3",children:[e.jsx("label",{htmlFor:"Phone",className:"block text-sm font-medium text-gray-700",children:"Phone"}),e.jsx("div",{className:"mt-1 flex rounded-md shadow-sm",children:e.jsx("input",{className:"w-full py-3 px-4 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",type:"text",name:"phone",onChange:i,value:t.phone})}),(a==null?void 0:a.phone)&&e.jsx("p",{className:"text-red-500",children:a==null?void 0:a.phone})]}),e.jsxs("div",{className:"col-span-6 ",children:[e.jsx("label",{htmlFor:"Description",className:"block text-sm font-medium text-gray-700",children:"Description"}),e.jsx("div",{className:"mt-1",children:e.jsx("textarea",{name:"description",rows:1,className:"w-full py-3 px-4 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Something",onChange:i,value:t.description})}),(a==null?void 0:a.description)&&e.jsx("p",{className:"text-red-500",children:a==null?void 0:a.description})]}),e.jsxs("div",{className:"col-span-6 sm:col-span-3",children:[e.jsx("label",{htmlFor:"Location",className:"block text-sm font-medium text-gray-700",children:"Location"}),e.jsxs("div",{className:"mt-1",children:[e.jsx(B,{handleManualInputChange:i,setFormData:d,searchLocation:t.searchLocation}),(a==null?void 0:a.searchLocation)&&e.jsx("p",{className:"text-red-500",children:a==null?void 0:a.searchLocation})]})]}),e.jsx("div",{className:"col-span-6 sm:col-span-3  ",children:e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(W,{longitude:t.location.coordinates[0],latitude:t.location.coordinates[1],updateCoordinates:w})})}),e.jsxs("div",{className:"col-span-6 sm:col-span-2 mt-(-10)",children:[e.jsx("label",{htmlFor:"Table rate",className:"block text-sm font-medium text-gray-700",children:"Table rate"}),e.jsx("div",{className:"mt-1 flex rounded-md shadow-sm",children:e.jsx("input",{className:"w-full py-3 px-4 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",type:"text",name:"tableRatePerPerson",onChange:i,value:t.tableRatePerPerson})}),(a==null?void 0:a.tableRatePerPerson)&&e.jsx("p",{className:"text-red-500",children:a==null?void 0:a.tableRatePerPerson})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center",children:[e.jsx("label",{className:"block text-base font-medium text-gray-700 pt-5",children:"Select time :"}),e.jsxs("div",{className:"mt-1 flex  flex-col sm:flex-row items-center gap-2",children:[e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("p",{className:"text-sm font-medium",children:"Opening time"}),e.jsx("input",{type:"time",name:"openingTime",value:t.openingTime,onChange:i,className:"ml-5 bg-white py-2 px-3 border border-gray-300 rounded-md shadow-sm text-sm leading-4 font-medium text-gray-700 hover:bg-gray-50 focus:outline-none "})]}),e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("p",{className:"text-sm font-medium",children:"Closing time"}),e.jsx("input",{type:"time",name:"closingTime",value:t.closingTime,onChange:i,className:"ml-5  bg-white py-2 px-3 border border-gray-300 rounded-md shadow-sm text-sm leading-4 font-medium text-gray-700 hover:bg-gray-50 focus:outline-none "})]}),(a==null?void 0:a.openingTime)&&e.jsx("p",{className:"text-red-500",children:a==null?void 0:a.openingTime})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"featured_image",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Featured image"}),t.primaryImage&&e.jsx("div",{className:"mt-6 mb-2",children:e.jsx("img",{src:t.primaryImage,alt:" Featured Image",className:"h-24 w-auto rounded-md"})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"featured_image",className:"absolute opacity-0 w-full h-full cursor-pointer",type:"file",accept:"image/*",onChange:h}),e.jsx("label",{htmlFor:"featured_image",className:"flex items-center justify-center w-32 h-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 dark:text-gray-400 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 cursor-pointer",children:"Choose File"})]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-300",children:"PNG, JPG"}),e.jsx("button",{className:` w-32 h-10 rounded-lg  bg-green-300 ${!u&&"cursor-not-allowed"}`,type:"button",onClick:()=>f("featuredImage"),disabled:!u,children:N?e.jsxs("span",{className:"inline-flex items-center gap-2",children:[e.jsx(L,{className:"animate-spin mx-auto"}),"Uploading"]}):"Upload"})]}),u&&e.jsx("img",{src:u,alt:"Featured preview",className:"mt-2 h-24 w-auto"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"additional_images",className:"block mt-6 mb-2 text-sm font-medium text-gray-700",children:"Secondary images"}),t.secondaryImages.length>0&&e.jsx("div",{className:"mt-6 mb-2",children:e.jsx("div",{className:"flex flex-wrap gap-2 ",children:t.secondaryImages.map((m,g)=>e.jsxs("div",{className:"relative h-24 w-auto rounded-md",children:[e.jsx("img",{src:m,alt:`Secondary Image ${g}`,className:"h-full rounded-md"}),e.jsx(H,{className:"absolute -top-5 right-0 cursor-pointer w-5 h-5 text-red-600",onClick:()=>{b(m),x(!0)}})]},g))})}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"featured_image",className:"absolute opacity-0 w-full h-full cursor-pointer",type:"file",accept:"image/*",onChange:I,multiple:!0}),e.jsx("label",{htmlFor:"featured_image",className:"flex items-center justify-center w-32 h-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 dark:text-gray-400 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 cursor-pointer",children:"Choose Files"})]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-300",children:"PNG, JPG"}),e.jsx("button",{className:` w-32 h-10 rounded-lg  bg-green-300 font-medium ${!p.length&&"cursor-not-allowed"}`,type:"button",disabled:!p,onClick:()=>f(),children:v?e.jsxs("span",{className:"inline-flex items-center gap-2",children:[e.jsx(L,{className:"animate-spin mx-auto"}),"Uploading"]}):"Upload"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:p.map((m,g)=>e.jsx("img",{src:m,alt:`Preview ${g}`,className:"h-24 w-auto"},g))})]})]}),e.jsx("div",{className:"px-4 py-3 bg-gray-50 text-right sm:px-6",children:e.jsx("button",{type:"submit",className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Save"})})]})})]}),C&&e.jsx(q,{setIsOpen:m=>x(m),handleConfirmation:P,action:"delete image"})]})};export{ye as default};
